/* lru_paging.c */
#include <stdio.h>
#define FRAMES 3

int main(){
    int ref[] = {7,0,1,2,0,3,0,4,2,3,0,3,2};
    int n = sizeof(ref)/sizeof(ref[0]);
    int frames[FRAMES]; for(int i=0;i<FRAMES;i++) frames[i]=-1;
    int time[FRAMES]; for(int i=0;i<FRAMES;i++) time[i]=0;
    int tcount=0, faults=0;
    for(int i=0;i<n;i++){
        tcount++;
        int page = ref[i], hit=-1;
        for(int j=0;j<FRAMES;j++) if(frames[j]==page) { hit=j; break; }
        if(hit!=-1){ time[hit]=tcount; continue; }
        /* miss: find LRU */
        int lru = 0;
        for(int j=1;j<FRAMES;j++) if(time[j] < time[lru]) lru=j;
        frames[lru]=page; time[lru]=tcount; faults++;
    }
    printf("LRU page faults = %d\n", faults);
    return 0;
}
